!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.omnizoom=e():t.omnizoom=e()}(window,function(){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class n{constructor(t){this.elems=[],void 0!==t&&void 0!==t.zoomCoef?this.zoomCoef=t.zoomCoef:this.zoomCoef=1.05,this.zFactor=0,this.xDown=void 0,this.yDown=void 0,this.xDrag=void 0,this.yDrag=void 0,this.panning=void 0;const e=this.zoomCoef**this.zFactor;return this.transformation=[0,0,e],this}addElem(t){return this.elems.push(t),this}zoom(t,e,o,n){return this.transformation=this.zoomHelper(t,e,o,n),this.setTransformation(...this.transformation),this}zoomHelper(t,e,o,n){const[i,s,r]=this.transformation;switch(n){case 0:return this.transformation;case 1:this.zFactor+=1;break;case-1:this.zFactor-=1;break;default:console.log("something went wrong setting the zoom level")}const a=this.zoomCoef**this.zFactor;if(a<1)return this.transformation;const[c,l]=this.clientPosToRelPos(t,e,o);let h=c-(c-i)/r*a,f=l-(l-s)/r*a;return[h,f]=this.keepInBounds(t,h,f,a),[h,f,a]}clientPosToRelPos(t,e,o){const n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop;return[e-t.offsetLeft+n,o-t.offsetTop+i]}keepInBounds(t,e,o,n){const i=t.clientWidth,s=t.clientHeight;return e>0?e=0:e+i*n<i&&(e=i*(1-n)),o>0?o=0:o+s*n<s&&(o=s*(1-n)),[e,o]}pan(t,e,o){return this.transformation=this.panHelper(t,e,o),this.setTransformation(...this.transformation),this}panHelper(t,e,o){const n=this.transformation[2],i=e-this.xDown,s=o-this.yDown;if(void 0===i||void 0===s)return this.transformation;let r=this.xDrag+i,a=this.yDrag+s;return[r,a]=this.keepInBounds(t,r,a,n),[r,a,n]}addZoom(t){return this.elems.forEach(e=>{e.onwheel=(o=>{o.preventDefault();const n=o.clientX,i=o.clientY,s=o.deltaY<0?1:-1;this.zoom(e,n,i,s),void 0!==t&&t(...this.transformation)})}),this}addPan(t){return this.elems.forEach((e,o)=>{e.onmousedown=(t=>{t.ctrlKey&&(t.preventDefault(),this.panning=e,e.classList.add("grabbing"),e.classList.remove("grab"),this.xDown=t.clientX,this.yDown=t.clientY,this.xDrag=this.transformation[0],this.yDrag=this.transformation[1])}),e.onmousemove=(o=>{this.onPan(e,o,t)}),window.addEventListener("mousemove",o=>{this.onPan(e,o,t)}),e.onmouseup=(t=>{this.offPan(e,t)}),window.addEventListener("mouseup",t=>{this.offPan(e,t)}),document.addEventListener("keydown",t=>{"Control"===t.key&&(void 0!==this.panning?e.classList.add("grabbing"):e.classList.add("grab"))}),document.addEventListener("keyup",t=>{"Control"===t.key&&(e.classList.remove("grab"),e.classList.remove("grabbing"))})}),this}onPan(t,e,o){if(e.ctrlKey&&this.panning===t){const n=e.clientX,i=e.clientY;this.pan(t,n,i),void 0!==o&&o(...this.transformation)}}offPan(t,e){t.classList.remove("grabbing"),void 0!==this.panning&&t.classList.add("grab"),this.xDown=void 0,this.yDown=void 0,this.panning=void 0}setTransformation(t,e,o){return this.elems.forEach(n=>{this.setTransformationHelper(n,t,e,o)}),this}setTransformationHelper(t,e,o,n){const i=`translate3D(${e}px,${o}px,0) scale(${n})`;return t.style.setProperty("transform",i),this}onClick(t){this.elems.forEach(e=>{e.onclick=(o=>{if("Control"===o.key)return;const n=o.clientX,i=o.clientY,[s,r]=this.clientPosToRelPos(e,n,i),[a,c,l]=this.transformation,h=(s-a)/l,f=(r-c)/l,[u,d]=this.getRealPoint(e,h,f);void 0!==t&&t(h,f,u,d)})})}getRealPoint(t,e,o){switch(t.tagName){case"IMG":return[e*t.naturalWidth/t.clientWidth,o*t.naturalHeight/t.clientHeight];case"VIDEO":return[e*t.videoWidth/t.clientWidth,o*t.videoHeight/t.clientHeight];default:return[e,o]}}}o.d(e,"Zoomer",function(){return n})}])});